{"version":3,"sources":["reducers/mainReducer.js","components/TopMenu.js","actions/appActions.js","components/SideMenu.js","core/helpers.js","components/Editor.js","components/EditorPlace.js","core/Container.js","core/DataManager.js","core/Control.js","configuration/Settings.js","App.js","serviceWorker.js","index.js"],"names":["mainReducerController","state","action","type","editorBounds","imageSize","addImagesDefaultSize","addImagesTransform","concat","index","x","width","y","height","scale","addImagesDefaultScale","rotation","addImagesMatrix","addImagesBounds","justAdded","transform","matrix","bounds","data","loaded","mainReducer","extraAction","TopMenu","props","store","left_buttonHandler","bind","right_buttonHandler","this","unsubscribe","subscribe","onStoreChange","mounted","getState","setState","event","dispatch","children","push","id","key","className","title","style","left","onClick","right","React","createElement","Component","SideMenu","image_clickHandler","clear_buttonHandler","target","Number","substr","useImage","clearImage","addImagesSrc","i","length","imageSrc","top","src","decomposeMatrix","m","Point","deltaTransformPoint","point","a","c","b","d","px","py","skewX","Math","PI","atan2","skewY","translateX","tx","translateY","ty","scaleX","sqrt","scaleY","matrixTransforms","inMatrix","Editor","currentZ","targetZs","targetRefs","moveableRefs","createRef","containerRef","movable_transformHandler","movable_transformEndHandler","prevProps","prevState","snapshot","params","t","exec","window","getComputedStyle","splice","getBoundingClientRect","geom","offsetY","decomp","updateImage","indexes","z","sort","ii","addImageTransform","addImageMatrix","addImageBounds","ref","onLoad","onMouseDown","current","pinchThreshold","container","draggable","scalable","resizable","warpable","rotatable","pinchable","keepRatio","origin","throttleDrag","throttleRotate","throttleResize","throttleScale","onDrag","onResize","onScale","onWarp","onRotate","onPinch","onDragEnd","onScaleEnd","onResizeEnd","onWarpEnd","onRotateEnd","onPinchEnd","EditorPlace","editorRef","editorScale","editorX","editorY","updateBounds","clientWidth","clientHeight","lastWidth","lastHeight","min","mainImageSrc","Container","sideMenu","topMenu","DataManager","isLoading","isLoaded","loader","result","reloadData","saveStorageData","localStorageManager","load","setStorageData","save","Control","actionMap","appStartDelay","loadTimeout","setTimeout","app","onNext","onPrev","onSave","dataForStorageChanged","clearTimeout","stopTimeout","dataLoaded","loadDataError","reloadTimeout","settings","assetsUrl","localStoreName","isMobile","MobileDetect","navigator","userAgent","mobile","isLocal","test","document","location","toString","Store","createStore","__REDUX_DEVTOOLS_EXTENSION__","App","initHandler","resizeHandler","windowInnerWidth","documentElement","body","innerWidth","windowInnerHeight","innerHeight","windowWidth","windowHeight","updateLayout","setStoreData","addEventListener","onInit","Boolean","hostname","match","element","getElementById","console","log","getAttribute","ReactDOM","render","StrictMode","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.f6d78a0d.chunk.js","sourcesContent":["let mainReducerController = (state={}, action) => {\r\n\r\n    // console.log(\"mainReducer\",action);\r\n\r\n    switch (action.type) {\r\n\r\n\r\n      case 'USE_IMAGE': {\r\n        let editorBounds=state.editorBounds;\r\n        let imageSize=state.addImagesDefaultSize;\r\n\r\n        let addImagesTransform=state.addImagesTransform.concat();\r\n        if (!addImagesTransform[action.index]) {\r\n          addImagesTransform[action.index]={\r\n            x:(editorBounds.width-imageSize.width)/2,\r\n            y:(editorBounds.height-imageSize.height)/2,\r\n            scale:state.addImagesDefaultScale,\r\n            rotation:0,\r\n          }\r\n        }\r\n\r\n        let addImagesMatrix=state.addImagesMatrix.concat();\r\n        if (!addImagesMatrix[action.index]) {\r\n          addImagesMatrix[action.index]=[\r\n            state.addImagesDefaultScale, 0, 0, state.addImagesDefaultScale, (editorBounds.width-imageSize.width)/2, (editorBounds.height-imageSize.height)/2\r\n          ]\r\n        }\r\n\r\n        let addImagesBounds=state.addImagesBounds.concat();\r\n        if (!addImagesBounds[action.index]) {\r\n          addImagesBounds[action.index]={\r\n            x:(editorBounds.width-imageSize.width)/2,\r\n            y:(editorBounds.height-imageSize.height)/2,\r\n            width:imageSize.width*state.addImagesDefaultScale,\r\n            height:imageSize.height*state.addImagesDefaultScale,\r\n          }\r\n        }\r\n\r\n        return {\r\n          ...state,\r\n          addImagesTransform,\r\n          addImagesMatrix,\r\n          addImagesBounds,\r\n          justAdded:true,\r\n        }\r\n      }\r\n\r\n      case 'REINIT_MOVABLE': {\r\n        return {\r\n          ...state,\r\n          justAdded:false,\r\n        }\r\n      }\r\n\r\n      case 'CLEAR_IMAGE': {\r\n        let addImagesTransform=state.addImagesTransform.concat();\r\n        addImagesTransform[action.index]=null;\r\n\r\n        let addImagesMatrix=state.addImagesMatrix.concat();\r\n        addImagesMatrix[action.index]=null;\r\n\r\n        let addImagesBounds=state.addImagesBounds.concat();\r\n        addImagesBounds[action.index]=null;\r\n\r\n        return {\r\n          ...state,\r\n          addImagesTransform,\r\n          addImagesMatrix,\r\n          addImagesBounds,\r\n        }\r\n      }\r\n\r\n      case 'UPDATE_IMAGE': {\r\n\r\n        let addImagesTransform=state.addImagesTransform.concat();\r\n        if (action.transform) {\r\n          addImagesTransform[action.index]=action.transform;\r\n        }\r\n\r\n        let addImagesMatrix=state.addImagesMatrix.concat();\r\n        if (action.matrix) {\r\n          addImagesMatrix[action.index]=action.matrix;\r\n        }\r\n\r\n        let addImagesBounds=state.addImagesBounds.concat();\r\n        if (action.bounds) {\r\n          addImagesBounds[action.index]=action.bounds;\r\n        }\r\n\r\n        // console.log(addImagesTransform);\r\n        // console.log(addImagesMatrix);\r\n\r\n        return {\r\n          ...state,\r\n          addImagesTransform,\r\n          addImagesMatrix,\r\n          addImagesBounds,\r\n          justAdded:false,\r\n        }\r\n      }\r\n\r\n      // case 'WAITING_FOR_RELOAD_STORE_DATA':\r\n      // case 'STORAGE_DATA_SAVED':\r\n      // case 'SAVE_STORAGE_DATA':\r\n      // case 'SET_STORAGE_DATA':\r\n      // case 'LOAD_STORE_DATA_ERROR':\r\n      // case 'RELOAD_STORE_DATA':\r\n\r\n      case 'APP_INIT': {\r\n        return {\r\n          ...state,\r\n          ...action.data,\r\n        }\r\n      }\r\n\r\n      case 'SET_STORE_DATA': {\r\n        // console.log(\"!!!?????????!!!!!!!!!\");\r\n        return {\r\n          ...state,\r\n          ...action.data,\r\n          loaded:true,\r\n          justAdded:true,\r\n        }\r\n      }\r\n\r\n      case 'GO_PREV': {\r\n        return {\r\n          ...state,\r\n          action:\"prev\",\r\n        }\r\n      }\r\n\r\n      case 'GO_NEXT': {\r\n        return {\r\n          ...state,\r\n          action:\"next\",\r\n        }\r\n      }\r\n\r\n      case 'SAVE': {\r\n        return {\r\n          ...state,\r\n          action:\"save\",\r\n        }\r\n      }\r\n\r\n      case 'CLEAR_ACTION': {\r\n        return {\r\n          ...state,\r\n          action:null,\r\n        }\r\n      }\r\n\r\n      default:\r\n        return state\r\n    }\r\n}\r\n\r\nconst mainReducer = (state={}, action) => {\r\n\r\n  if (action.extraAction) {\r\n    state = mainReducer(state,action.extraAction);\r\n  }\r\n\r\n  state = mainReducerController(state,action);\r\n\r\n  return state;\r\n}\r\n\r\n\r\nexport default mainReducer\r\n","import React, { Component } from 'react';\r\nimport {\r\n  goPrev,\r\n  goNext,\r\n} from '../actions/appActions';\r\n\r\nclass TopMenu extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state={\r\n    };\r\n    this.store = this.props.store;\r\n    this.left_buttonHandler=this.left_buttonHandler.bind(this);\r\n    this.right_buttonHandler=this.right_buttonHandler.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      this.setState(state);\r\n    }\r\n  }\r\n\r\n  left_buttonHandler(event) {\r\n    this.store.dispatch(\r\n      goPrev()\r\n    )\r\n  }\r\n\r\n  right_buttonHandler(event) {\r\n    this.store.dispatch(\r\n      goNext()\r\n    )\r\n  }\r\n\r\n  render() {\r\n\r\n    let children = [];\r\n    children.push(this.props.children);\r\n\r\n    if (this.state.loaded) {\r\n\r\n      children.push(\r\n        <div\r\n          id=\"title\"\r\n          key=\"title\"\r\n          className=\"topMenuTitle\"\r\n          >{this.state.title}</div>\r\n      );\r\n\r\n      children.push(\r\n        <div\r\n          id=\"left\"\r\n          key=\"left\"\r\n          className=\"topMenuButton\"\r\n          style={{\r\n            left:\"1%\",\r\n          }}\r\n          onClick={this.left_buttonHandler}>Назад</div>\r\n      );\r\n\r\n      children.push(\r\n        <div\r\n          id=\"right\"\r\n          key=\"right\"\r\n          className=\"topMenuButton\"\r\n          style={{\r\n            right:\"1%\",\r\n          }}\r\n          onClick={this.right_buttonHandler}>Вперед</div>\r\n      );\r\n    }\r\n    return React.createElement(\r\n      'div',\r\n      { id:'TopMenu',\r\n        style:this.props.style,\r\n      },\r\n      children\r\n      );\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\nexport default TopMenu;\r\n","export const useImage = (index) => {\r\n  return {\r\n    type: 'USE_IMAGE',\r\n    index,\r\n  }\r\n}\r\n\r\nexport const clearImage = (index) => {\r\n  return {\r\n    type: 'CLEAR_IMAGE',\r\n    index,\r\n  }\r\n}\r\n\r\nexport const updateImage = (index,transform,matrix,bounds) => {\r\n  return {\r\n    type: 'UPDATE_IMAGE',\r\n    index,\r\n    transform,\r\n    matrix,\r\n    bounds,\r\n  }\r\n}\r\n\r\n\r\nexport const reinitMovable = () => {\r\n  return {\r\n    type: 'REINIT_MOVABLE',\r\n  }\r\n}\r\n\r\nexport const goPrev = () => {\r\n  return {\r\n    type: 'GO_PREV',\r\n  }\r\n}\r\n\r\nexport const goNext = () => {\r\n  return {\r\n    type: 'GO_NEXT',\r\n  }\r\n}\r\n\r\nexport const save = () => {\r\n  return {\r\n    type: 'SAVE',\r\n  }\r\n}\r\n\r\nexport const clearAction = () => {\r\n  return {\r\n    type: 'CLEAR_ACTION',\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\nexport const appInit = (data) => {\r\n  return {\r\n    type: 'APP_INIT',\r\n    data:{\r\n      ...data,\r\n    },\r\n  }\r\n}\r\n\r\nexport const setStoreData = (data) => {\r\n  return {\r\n    type: 'SET_STORE_DATA',\r\n    data:{\r\n      ...data,\r\n    },\r\n  }\r\n}\r\n\r\nexport const loadStoreDataError = (data) => {\r\n  return {\r\n    type: 'LOAD_STORE_DATA_ERROR',\r\n    data:{\r\n      ...data,\r\n      dataLoaded:false,\r\n      reloadData:false,\r\n      loadDataError:true,\r\n    },\r\n  }\r\n}\r\n\r\nexport const reloadStoreData = () => {\r\n  return {\r\n    type: 'RELOAD_STORE_DATA',\r\n    data:{\r\n      dataLoaded:false,\r\n      reloadData:true,\r\n      loadDataError:false,\r\n    },\r\n  }\r\n}\r\n\r\nexport const waitingForReloadStoreData = () => {\r\n  return {\r\n    type: 'WAITING_FOR_RELOAD_STORE_DATA',\r\n    data:{\r\n      dataLoaded:false,\r\n    },\r\n  }\r\n}\r\n\r\nexport const setAppData = (data) => {\r\n  return {\r\n    type: 'SET_APP_DATA',\r\n    data,\r\n  }\r\n}\r\n\r\nexport const setStorageData = (data) => {\r\n  return {\r\n    type: 'SET_STORAGE_DATA',\r\n    data,\r\n  }\r\n}\r\n\r\nexport const saveStorageData = () => {\r\n  return {\r\n    type: 'SAVE_STORAGE_DATA',\r\n    data:{\r\n      saveStorageData:true,\r\n      dataForStorageChanged:null,\r\n    }\r\n  }\r\n}\r\n\r\nexport const storageDataSaved = () => {\r\n  return {\r\n    type: 'STORAGE_DATA_SAVED',\r\n    data:{\r\n      saveStorageData:false,\r\n    }\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\n\r\nimport {\r\n  useImage,\r\n  clearImage,\r\n} from '../actions/appActions';\r\n\r\nclass SideMenu extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state={\r\n    };\r\n    this.store = this.props.store;\r\n    this.image_clickHandler=this.image_clickHandler.bind(this);\r\n    this.clear_buttonHandler=this.clear_buttonHandler.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      this.setState(state);\r\n    }\r\n  }\r\n\r\n  image_clickHandler(event) {\r\n    let id=event.target.id;\r\n    let index=Number(id.substr(3));\r\n    this.store.dispatch(\r\n      useImage(index)\r\n    )\r\n  }\r\n\r\n  clear_buttonHandler(event) {\r\n    let id=event.target.id;\r\n    let index=Number(id.substr(3));\r\n    this.store.dispatch(\r\n      clearImage(index)\r\n    )\r\n  }\r\n\r\n  render() {\r\n\r\n    let children = [];\r\n    children.push(this.props.children);\r\n\r\n    if ((this.state)&&(this.state.loaded)&&(this.state.addImagesSrc)) {\r\n\r\n      for (let i = 0; i < this.state.addImagesSrc.length; i++) {\r\n        let imageSrc = this.state.addImagesSrc[i];\r\n        let addImageTransform = this.state.addImagesMatrix[i];\r\n        if (!addImageTransform) {\r\n          children.push(\r\n            <img\r\n              id={\"img\"+i}\r\n              key={\"img\"+i}\r\n              src={imageSrc}\r\n              className=\"sideMenuImage\"\r\n              style={{\r\n                top:(i/this.state.addImagesSrc.length)*100+(0.5*100/this.state.addImagesSrc.length)+\"%\",\r\n                transform:\"translateY(-50%)\",\r\n                height:(1/this.state.addImagesSrc.length)*100+\"%\",\r\n              }}\r\n              onClick={this.image_clickHandler}\r\n            />\r\n          );\r\n        } else {\r\n          children.push(\r\n            <div\r\n              id={\"clr\"+i}\r\n              key={\"clr\"+i}\r\n              className=\"sideMenuButton\"\r\n              style={{\r\n                top:(i/this.state.addImagesSrc.length)*100+(0.5*100/this.state.addImagesSrc.length)+\"%\",\r\n                transform:\"translate(-50%,-50%)\",\r\n              }}\r\n              onClick={this.clear_buttonHandler}>Вернуть</div>\r\n          );\r\n\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    return React.createElement(\r\n      'div',\r\n      { id:'SideMenu',\r\n        style:this.props.style,\r\n      },\r\n      children\r\n      );\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\nexport default SideMenu;\r\n","import MobileDetect from 'mobile-detect'\r\nimport path from \"path\"\r\n\r\nexport const callLater = (callback,delay = 100) => {\r\n  return setTimeout(callback,delay);\r\n}\r\n\r\nexport const isMobile = () => {\r\n  var mobileDetect = new MobileDetect(window.navigator.userAgent);\r\n  return mobileDetect.mobile();\r\n}\r\n\r\nexport const isLocal = () => {\r\n  return !(/^h/.test(document.location.toString()));\r\n}\r\n\r\nexport const objectIsEmpty = (object) => {\r\n  return Object.keys(object).length === 0 && object.constructor === Object;\r\n}\r\n\r\nexport const correctUrl = (url,assetsUrl) => {\r\n\r\n  if (url) {\r\n    if (url.substr(0,1)===\"/\") {\r\n      if (!assetsUrl) {\r\n        assetsUrl=\".\";\r\n      }\r\n      url=path.join(assetsUrl,url);\r\n    }\r\n  }\r\n\r\n  return url;\r\n\r\n}\r\n\r\nexport const openLink = (link) => {\r\n  // let url=correctUrl(link)\r\n  // console.log(\"??\",url);\r\n  window.open(link,\"_blank\")\r\n}\r\n\r\nexport const decomposeMatrix = (m) => {\r\n\r\n  function Point(x, y)\r\n  {\r\n    return { x: x, y: y };\r\n  }\r\n\r\n  function matrixTransforms(matrix) {\r\n    // calculate delta transform point\r\n    var px = deltaTransformPoint(matrix, new Point(0, 1));\r\n    var py = deltaTransformPoint(matrix, new Point(1, 0));\r\n\r\n    // calculate skew\r\n    var skewX = ((180 / Math.PI) * Math.atan2(px.y, px.x) - 90);\r\n    var skewY = ((180 / Math.PI) * Math.atan2(py.y, py.x));\r\n\r\n    return {\r\n      translateX:matrix.tx,\r\n      translateY:matrix.ty,\r\n      scaleX:Math.sqrt(matrix.a * matrix.a + matrix.b * matrix.b),\r\n      scaleY:Math.sqrt(matrix.c * matrix.c + matrix.d * matrix.d),\r\n      skewX:skewX,\r\n      skewY:skewY,\r\n      rotation:skewX // rotation is the same as skew x\r\n    }\r\n  }\r\n\r\n  function deltaTransformPoint(matrix, point)  {\r\n    //return matrix.deltaTransformPoint(point);\r\n    var dx = point.x * matrix.a + point.y * matrix.c + 0;\r\n    var dy = point.x * matrix.b + point.y * matrix.d + 0;\r\n    return new Point(dx, dy);\r\n  }\r\n\r\n  function asDecompose(inMatrix)\r\n  {\r\n    var matrix = {\r\n      a: inMatrix[0],\r\n      b: inMatrix[1],\r\n      c: inMatrix[2],\r\n      d: inMatrix[3],\r\n      tx: inMatrix[4],\r\n      ty: inMatrix[5]\r\n    };\r\n\r\n    return matrixTransforms(matrix);\r\n  }\r\n\r\n  return asDecompose(m)\r\n}\r\n","import React, { Component } from 'react';\r\nimport Moveable from \"react-moveable\";\r\n\r\nimport {\r\n  updateImage,\r\n} from '../actions/appActions';\r\n\r\nimport {\r\n  decomposeMatrix,\r\n} from '../core/helpers.js';\r\n\r\n\r\nclass Editor extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state={}\r\n    this.store = this.props.store;\r\n\r\n    this.currentZ=0;\r\n\r\n    this.targetZs=[];\r\n    this.targetRefs=[];\r\n    this.moveableRefs=[];\r\n    for (let i = 0; i < 10; i++) {\r\n      this.targetZs.push(0);\r\n      this.targetRefs.push(React.createRef());\r\n      this.moveableRefs.push(React.createRef());\r\n    }\r\n\r\n    this.containerRef=React.createRef();\r\n\r\n    this.state={}\r\n\r\n    this.movable_transformHandler=this.movable_transformHandler.bind(this);\r\n    this.movable_transformEndHandler=this.movable_transformEndHandler.bind(this);\r\n\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      this.setState(state);\r\n    }\r\n  }\r\n\r\n  movable_transformHandler(params) {\r\n    if (params.transform) {\r\n      params.target.style.transform=params.transform;\r\n    }\r\n    let index=Number(params.target.id.substr(3));\r\n\r\n    // let transform=this.state.addImagesTransform[index];\r\n    //\r\n    // if (params.translate!=null) {\r\n    //   transform.x+=Number(params.delta[0])*transform.scale;\r\n    //   transform.y+=Number(params.delta[1])*transform.scale;\r\n    // }\r\n    // if (params.scale!=null) {\r\n    //   transform.scale*=Number(params.delta[0]);\r\n    // }\r\n    // if (params.rotate!=null) {\r\n    //   transform.rotation+=Number(params.delta);\r\n    // }\r\n\r\n    // this.store.dispatch(\r\n    //   updateImage(index,transform)\r\n    // )\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n  movable_transformEndHandler(params) {\r\n    let index=Number(params.target.id.substr(3));\r\n    let t=(/\\((.+),\\s*(.+),\\s*(.+),\\s*(.+),\\s*(.+),\\s*(.+)\\)/g).exec(window.getComputedStyle(params.target,null).transform);\r\n    let matrix={\r\n      ...this.state.addImagesMatrix,\r\n    };\r\n    if (t) {\r\n      t.splice(0,1);\r\n      matrix=[]\r\n      for (let i = 0; i < t.length; i++) {\r\n        matrix.push(t[i])\r\n      }\r\n    }\r\n\r\n    let bounds=params.target.getBoundingClientRect();\r\n    bounds={\r\n      x:(bounds.x)/this.props.geom.scale-this.props.geom.x,\r\n      y:(bounds.y-this.props.geom.offsetY)/this.props.geom.scale-this.props.geom.y,\r\n      width:bounds.width/this.props.geom.scale,\r\n      height:bounds.height/this.props.geom.scale,\r\n    }\r\n\r\n    let decomp = decomposeMatrix(matrix);\r\n\r\n    let transform={\r\n      x:decomp.translateX,\r\n      y:decomp.translateY,\r\n      rotation:decomp.rotation,\r\n      scale:decomp.scaleX,\r\n    }\r\n\r\n    this.currentZ++;\r\n    this.targetZs[index]=this.currentZ;\r\n\r\n    // console.log(\"S=\"+transform.scale,\"R=\"+transform.rotation);\r\n    // console.log(\"X=\"+bounds.x,\"Y=\"+bounds.x,\"W=\"+bounds.width,\"H=\"+bounds.height);\r\n\r\n    this.store.dispatch(\r\n      updateImage(index,transform,matrix,bounds)\r\n    )\r\n\r\n  }\r\n\r\n\r\n  render() {\r\n\r\n    let children = [];\r\n    children.push(this.props.children);\r\n\r\n    if (this.state.addImagesSrc) {\r\n\r\n      let indexes=[]\r\n      for (let i = 0; i < this.state.addImagesSrc.length; i++) {\r\n        indexes.push({i,z:this.targetZs[i]});\r\n      }\r\n      indexes.sort((a,b)=>{return a.z-b.z});\r\n\r\n      for (let ii = 0; ii < indexes.length; ii++) {\r\n        let i=indexes[ii].i;\r\n        let imageSrc = this.state.addImagesSrc[i];\r\n        let addImageTransform = this.state.addImagesTransform[i];\r\n        let addImageMatrix = this.state.addImagesMatrix[i];\r\n        let addImageBounds = this.state.addImagesBounds[i];\r\n\r\n        if (addImageTransform&&addImageMatrix&&addImageBounds) {\r\n\r\n          children.push(\r\n            <img\r\n              id={\"img\"+i}\r\n              key={\"img\"+i}\r\n              src={imageSrc}\r\n              className=\"editorImage\"\r\n              ref={this.targetRefs[i]}\r\n              style={{\r\n                transform:`matrix(${addImageMatrix})`,\r\n                width:this.state.addImagesDefaultSize.width,\r\n                height:this.state.addImagesDefaultSize.height,\r\n              }}\r\n              onLoad={this.movable_transformEndHandler}\r\n              onMouseDown={this.movable_transformEndHandler}\r\n            />\r\n          );\r\n\r\n          // children.push(\r\n          //   <div\r\n          //     id={\"tst\"+i}\r\n          //     key={\"tst\"+i}\r\n          //     style={{\r\n          //       position:\"absolute\",\r\n          //       display:\"block\",\r\n          //       width:addImageBounds.width+\"px\",\r\n          //       height:addImageBounds.height+\"px\",\r\n          //       left:addImageBounds.x+\"px\",\r\n          //       top:addImageBounds.y+\"px\",\r\n          //       background:\"#000\",\r\n          //       pointerEvents:\"none\",\r\n          //       opacity:0.2,\r\n          //     }}\r\n          //   />\r\n          // );\r\n          //\r\n          // console.log(`translate(${addImageTransform.x}px,${addImageTransform.y}px) rotate(${addImageTransform.rotation}deg) scale(${addImageTransform.scale})`);\r\n          //\r\n          // children.push(\r\n          //   <div\r\n          //     id={\"trt\"+i}\r\n          //     key={\"trt\"+i}\r\n          //     style={{\r\n          //       position:\"absolute\",\r\n          //       display:\"block\",\r\n          //       transform:`translate(${addImageTransform.x}px,${addImageTransform.y}px) rotate(${addImageTransform.rotation}deg) scale(${addImageTransform.scale})`,\r\n          //       width:this.state.addImagesDefaultSize.width,\r\n          //       height:this.state.addImagesDefaultSize.height,\r\n          //       background:\"#ff0000\",\r\n          //       pointerEvents:\"none\",\r\n          //       opacity:0.3,\r\n          //     }}\r\n          //   />\r\n          // );\r\n          if (!this.state.justAdded) {\r\n          children.push(\r\n            <Moveable\r\n              key={\"Moveable\"+i}\r\n              ref={this.moveableRefs[i]}\r\n              target={this.targetRefs[i].current}\r\n              pinchThreshold={20}\r\n              container={this.containerRef.current}\r\n              draggable={true}\r\n              scalable={true}\r\n              resizable={false}\r\n              warpable={false}\r\n              rotatable={true}\r\n              pinchable={false}\r\n              keepRatio={true}\r\n              origin={false}\r\n              throttleDrag={1.5}\r\n              throttleRotate={0.2}\r\n              throttleResize={1}\r\n              throttleScale={0.01}\r\n              onDrag={this.movable_transformHandler}\r\n              onResize={this.movable_transformHandler}\r\n              onScale={this.movable_transformHandler}\r\n              onWarp={this.movable_transformHandler}\r\n              onRotate={this.movable_transformHandler}\r\n              onPinch={this.movable_transformHandler}\r\n              onDragEnd={this.movable_transformEndHandler}\r\n              onScaleEnd={this.movable_transformEndHandler}\r\n              onResizeEnd={this.movable_transformEndHandler}\r\n              onWarpEnd={this.movable_transformEndHandler}\r\n              onRotateEnd={this.movable_transformEndHandler}\r\n              onPinchEnd={this.movable_transformEndHandler}\r\n            />\r\n          )\r\n          }\r\n\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    return React.createElement(\r\n      'div',\r\n      { id:'Editor',\r\n        style:this.props.style,\r\n        ref:this.containerRef,\r\n      },\r\n      children\r\n      );\r\n  }\r\n}\r\n\r\nexport default Editor;\r\n","import React, { Component } from 'react';\r\nimport Editor from './Editor.js'\r\n\r\nclass EditorPlace extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.store = this.props.store;\r\n\r\n    this.ref=React.createRef()\r\n    this.containerRef=React.createRef()\r\n    this.editorRef=React.createRef()\r\n\r\n\r\n    this.state={\r\n      editorScale:.15,\r\n      editorX:0,\r\n      editorY:0,\r\n\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    this.updateBounds(this.ref.current.clientWidth,this.ref.current.clientHeight);\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      this.setState({\r\n        ...this.state,\r\n        ...state,\r\n      });\r\n    }\r\n  }\r\n\r\n  updateBounds(width,height) {\r\n    if ((this.lastWidth!==width)||(this.lastHeight!==height)) {\r\n      if (this.state.editorBounds) {\r\n        this.lastWidth=width;\r\n        this.lastHeight=height;\r\n        let bounds=this.state.editorBounds;\r\n        let editorScale=Math.min(width/bounds.width,height/bounds.height);\r\n        let editorX=(width-bounds.width*editorScale)/2/editorScale;\r\n        let editorY=(height-bounds.height*editorScale)/2/editorScale;\r\n        this.setState({\r\n          ...this.state,\r\n          editorScale,\r\n          editorX,\r\n          editorY,\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    let children = [];\r\n    children.push(this.props.children);\r\n\r\n    let offsetY=0;\r\n    if (this.ref.current) {\r\n      offsetY=this.ref.current.getBoundingClientRect().y;\r\n    }\r\n\r\n    let geom={\r\n      scale:this.state.editorScale,\r\n      x:this.state.editorX,\r\n      y:this.state.editorY,\r\n      offsetY,\r\n    }\r\n    \r\n    children.push(\r\n      <div\r\n        id=\"EditorContainer\"\r\n        key=\"EditorContainer\"\r\n        ref={this.containerRef}\r\n        style={{\r\n          width:(this.state.editorBounds)?this.state.editorBounds.width:0,\r\n          height:(this.state.editorBounds)?this.state.editorBounds.height:0,\r\n          transform:`scale(${this.state.editorScale}) translateX(${this.state.editorX}px) translateY(${this.state.editorY}px)`\r\n        }}\r\n      >\r\n        <Editor\r\n          id=\"Editor\"\r\n          key=\"Editor\"\r\n          scale={this.state.editorScale}\r\n          store={this.props.store}\r\n          ref={this.editorRef}\r\n          geom={geom}\r\n          style={{\r\n            width:(this.state.editorBounds)?this.state.editorBounds.width:0,\r\n            height:(this.state.editorBounds)?this.state.editorBounds.height:0,\r\n          }}\r\n        />\r\n        <img\r\n          id=\"MainImage\"\r\n          key=\"MainImage\"\r\n          src={this.state.mainImageSrc}\r\n        />\r\n      </div>\r\n    );\r\n\r\n    return React.createElement(\r\n      'div',\r\n      { id:'EditorPlace',\r\n        style:this.props.style,\r\n        ref:this.ref,\r\n      },\r\n      children\r\n      );\r\n  }\r\n}\r\n\r\nexport default EditorPlace;\r\n","import React, { Component } from 'react';\r\n\r\nimport TopMenu from '../components/TopMenu.js';\r\nimport SideMenu from '../components/SideMenu.js';\r\nimport EditorPlace from '../components/EditorPlace.js';\r\n\r\nclass Container extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {}\r\n    this.store = this.props.store;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      this.setState(state);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    let children = [];\r\n    children.push(this.props.children);\r\n\r\n    children.push(\r\n      <SideMenu\r\n        store={this.store}\r\n        key=\"SideMenu\"\r\n        style={{\r\n          width:(this.state.sideMenu)?this.state.sideMenu.width:0,\r\n          top:(this.state.topMenu)?this.state.topMenu.height:0,\r\n        }}\r\n      />\r\n    );\r\n\r\n    children.push(\r\n      <EditorPlace\r\n        store={this.store}\r\n        key=\"EditorPlace\"\r\n        style={{\r\n          right:(this.state.sideMenu)?this.state.sideMenu.width:0,\r\n          top:(this.state.topMenu)?this.state.topMenu.height:0,\r\n        }}\r\n      />\r\n    );\r\n\r\n    children.push(\r\n      <TopMenu\r\n        store={this.store}\r\n        key=\"TopMenu\"\r\n        style={{\r\n          height:(this.state.topMenu)?this.state.topMenu.height:0,\r\n        }}\r\n      />\r\n    );\r\n\r\n    return React.createElement(\r\n      'div',\r\n      { id:'Container',\r\n      },\r\n      children\r\n      );\r\n  }\r\n}\r\n\r\n// export default connect(\r\n//   null,\r\n//   null\r\n// )(Container);\r\n\r\nexport default Container;\r\n","import { Component } from 'react';\r\n\r\nimport { setStorageData, storageDataSaved } from '../actions/appActions';\r\n\r\n// import LocalStorageManager from './LocalStorageManager';\r\n\r\nclass DataManager extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.store = this.props.store;\r\n    this.state = {\r\n      isLoading:false,\r\n      isLoaded:false,\r\n    }\r\n    this.loader=null;\r\n    this.result=null;\r\n\r\n  }\r\n\r\n/* ++++ React methods ++++ */\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    // this.load();\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n  }\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n      let state=this.store.getState();\r\n      // this.setState(state);\r\n      if (state.reloadData) {\r\n        // console.log(\"DataManager reloadData\");\r\n        // this.load()\r\n      } else\r\n      if (state.saveStorageData) {\r\n        // console.log(\"DataManager saveStorageData\");\r\n        this.saveStorageData();\r\n      }\r\n    }\r\n  }\r\n\r\n  loadStorageData()\r\n  {\r\n    let data=this.localStorageManager.load();\r\n    this.store.dispatch(\r\n      setStorageData(data)\r\n    );\r\n  }\r\n\r\n  saveStorageData()\r\n  {\r\n    // let state=this.store.getState();\r\n    this.localStorageManager.save({\r\n    });\r\n\r\n    this.store.dispatch(\r\n      storageDataSaved()\r\n    );\r\n  }\r\n\r\n  render () {\r\n    return null;\r\n  }\r\n\r\n}\r\nexport default DataManager;\r\n","import { Component } from 'react';\r\n\r\nimport {\r\n  reloadStoreData,\r\n  saveStorageData,\r\n  reinitMovable,\r\n  clearAction,\r\n } from '../actions/appActions';\r\n\r\nclass Control extends Component {\r\n\r\n  //--------------------------------------------------------------------------\r\n\t//\r\n\t// Constructor\r\n\t//\r\n\t//--------------------------------------------------------------------------\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {};\r\n    this.store = this.props.store;\r\n\r\n    this.actionMap={\r\n    }\r\n\r\n    this.appStartDelay=500;\r\n\r\n    // console.log(\"Control constructor\");\r\n\r\n  }\r\n\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  // React methods\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  componentDidMount() {\r\n    this.unsubscribe=this.store.subscribe(()=>{this.onStoreChange()});\r\n    this.mounted=true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    this.mounted=false;\r\n  }\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  // Own methods\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  onStoreChange() {\r\n    if (this.mounted) {\r\n\r\n      let state=this.store.getState();\r\n      // this.setState(state);\r\n\r\n      if (state.justAdded) {\r\n        this.loadTimeout=setTimeout(()=>{\r\n          this.store.dispatch(\r\n            reinitMovable()\r\n          );\r\n        }, 200);\r\n      }\r\n\r\n      if (state.action) {\r\n\r\n        this.store.dispatch(\r\n          clearAction()\r\n        );\r\n\r\n        switch (state.action) {\r\n\r\n          case \"next\": {\r\n            this.props.app.props.onNext(this.props.app);\r\n            break;\r\n          }\r\n\r\n          case \"prev\": {\r\n            this.props.app.props.onPrev(this.props.app);\r\n            break;\r\n          }\r\n\r\n          case \"save\": {\r\n            this.props.app.props.onSave(this.props.app);\r\n            break;\r\n          }\r\n\r\n          default:\r\n\r\n        }\r\n\r\n\r\n      }\r\n\r\n\r\n      //\r\n      //\r\n      // if (state.dataLoaded) {\r\n      //\r\n      //   // console.log(\"Control dataLoaded\",state.windowIsVisible);\r\n      //   if (state.windowIsVisible) {\r\n      //     // console.log(\"Control Wait for next load\");\r\n      //     this.store.dispatch(\r\n      //       waitingForReloadStoreData()\r\n      //     );\r\n      //     this.waitForReload();\r\n      //   } else {\r\n      //     // console.log(\"Tab is inactive. Do not load\");\r\n      //   }\r\n      //\r\n      // } else\r\n      // if (state.loadDataError) {\r\n      //   // console.log(\"Control loadDataError\");\r\n      //   this.store.dispatch(\r\n      //     reloadStoreData()\r\n      //   );\r\n      // } else\r\n      // }\r\n\r\n      if (state.dataForStorageChanged) {\r\n      // console.log(\"Control dataForStorageChanged\");\r\n        this.store.dispatch(\r\n          saveStorageData()\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  stopTimeout() {\r\n    if (this.loadTimeout) {\r\n      clearTimeout(this.loadTimeout)\r\n      this.loadTimeout=null;\r\n    }\r\n  }\r\n\r\n  waitForReload() {\r\n    // console.log(\"Control waitForReload\");\r\n    this.stopTimeout();\r\n\r\n    this.loadTimeout=setTimeout(()=>{\r\n      // console.log(\"Control Reload\");\r\n      this.store.dispatch(\r\n        reloadStoreData()\r\n      );\r\n    },this.store.reloadTimeout);\r\n\r\n  }\r\n\r\n\r\n\r\n  render () {\r\n    return null;\r\n  }\r\n\r\n}\r\n\r\nexport default Control;\r\n","import { isMobile,isLocal } from '../core/helpers';\r\n\r\nconst settings = {\r\n\r\n    assetsUrl: \".\",\r\n    localStoreName:\"appState_261020\",\r\n\r\n    isMobile:isMobile(),\r\n    isLocal:isLocal(),\r\n\r\n    topMenu:{\r\n      height:\"5%\",\r\n    },\r\n\r\n    sideMenu:{\r\n      width:\"10%\",\r\n    },\r\n\r\n    editorBounds:{\r\n      width:0,\r\n      height:0,\r\n    },\r\n\r\n    addImagesDefaultSize:{\r\n      width:500,\r\n      height:500,\r\n    },\r\n\r\n    addImagesDefaultScale:0.5,\r\n\r\n    mainImageSrc:\"\",\r\n    addImagesSrc:[\"\",\"\",\"\"],\r\n    addImagesMatrix:[null,null,null],\r\n    addImagesBounds:[null,null,null],\r\n    addImagesTransform:[null,null,null],\r\n\r\n    title:\"\",\r\n}\r\n\r\nexport default settings;\r\n","import React, { Component } from 'react';\n\nimport mainReducer from './reducers/mainReducer'\nimport Container from './core/Container';\n\nimport DataManager from './core/DataManager';\nimport Control from './core/Control';\n\nimport { Provider } from 'react-redux'\nimport { createStore } from 'redux'\n\nimport { appInit, setStoreData } from './actions/appActions';\n\nimport settings from './configuration/Settings';\n\nimport './css/app.css';\n\nconst Store = createStore(\n  mainReducer,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n);\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {}\n\n    this.initHandler=this.initHandler.bind(this);\n    this.resizeHandler=this.resizeHandler.bind(this);\n  }\n\n  updateLayout() {\n    let windowInnerWidth=document.documentElement.clientWidth || document.body.clientWidth || window.innerWidth;\n    let windowInnerHeight=document.documentElement.clientHeight || document.body.clientHeight || window.innerHeight;\n\n    this.setState({\n      ...this.state,\n      windowWidth:windowInnerWidth,\n      windowHeight:windowInnerHeight,\n    });\n\n  }\n\n  initHandler(event) {\n    this.updateLayout();\n  }\n\n  resizeHandler(event) {\n    this.updateLayout();\n  }\n\n  setData(data) {\n    Store.dispatch(\n      setStoreData(data)\n    );\n  }\n\n  getData(data) {\n    return Store.getState();\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n  }\n\n  componentDidMount() {\n    Store.dispatch(\n      appInit(settings)\n    );\n\n    window.addEventListener(\"load\",this.initHandler);\n    window.addEventListener(\"resize\",this.resizeHandler);\n\n    // window.editorApp=this;\n    // if (window.onEditorAppReady) {\n    //   window.onEditorAppReady(this);\n    // }\n\n    this.props.onInit(this);\n\n  }\n\n  render() {\n    return (\n      <Provider store={Store}>\n        <Container\n          id=\"Container\"\n          windowWidth={this.state.windowWidth}\n          windowHeight={this.state.windowHeight}\n          store={Store}\n        >\n          <DataManager\n            store={Store}\n          />\n          <Control\n            app={this}\n            store={Store}\n          />\n        </Container>\n      </Provider>\n    );\n  }\n\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nlet element=document.getElementById('editorWidget');\n\nconsole.log(element.getAttribute(\"oninit\"));\n\nReactDOM.render(\n  <React.StrictMode>\n    <App\n      id=\"editorApp\"\n      onInit={window[element.getAttribute(\"oninit\")]}\n      onNext={window[element.getAttribute(\"onnext\")]}\n      onPrev={window[element.getAttribute(\"onprev\")]}\n    />\n  </React.StrictMode>,\n  element\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}